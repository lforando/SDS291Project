---
title: "SDS291 - Project"
author: "Lauren Forando, Elle Jo Whalen, Jemimah Charles"
date: "11/26/2019"
output: html_document
---


```{r, messages = FALSE, include = FALSE}
library(readxl)
library(tidyverse)
library(mosaic)
```

```{r, message = FALSE}
#Bringing in our dataset
bodyfat <- read_excel("bodyfat.xlsx")
attach(bodyfat)
#glimpse(bodyfat)
```

```{r, include = FALSE}
#Renaming variable columns for easier use
#we decided to rename our variable columns because the original variable names were too long and could easily be messed up. Using the dplyr package, we selected the variables we were interested in and put them into a new dataframe we titled "neck_size". Then, using the tidyverse package, we were able to use the rename function which allows us to rename any variable. We decided to rename the variables we were interested in with shorter names for easier coding purposes. 

neck_size <- bodyfat %>%
  select(`Age (years)`, `Weight (lbs)`, `Wrist circumference (cm)`, `Biceps (extended) circumference (cm)`, `Height (inches)`, `Neck circumference (cm)`) %>% rename(
  age = 'Age (years)',
  weight = 'Weight (lbs)',
  wrist = 'Wrist circumference (cm)',
  bicep = 'Biceps (extended) circumference (cm)',
  height = 'Height (inches)',
  neck = 'Neck circumference (cm)')
```

```{r}
#First, we wanted to analyze the relationship between anticipated neck size and age, weight, wrist circumference, bicept circumference, and height. Because we are looking at multiple predictor variables, we will be running a Multiple Linear Regression (MLR) model. 

#Multiple Regression Model With Our 5 Predictor Variables
neck_lm <- lm(neck ~ age + weight + wrist + bicep + height, data = neck_size)
summary(neck_lm)

#Multiple Regression Model w/o Height
no_height_lm <- lm(neck ~ age + weight + wrist + bicep, data = neck_size)
summary(no_height_lm)

#Multiple Regression Model w/o Height and Age
no_age_lm <- lm(neck ~ weight + wrist + bicep, data = neck_size)
summary(no_age_lm)


anova(neck_lm, no_height_lm, no_age_lm)


#Including height only increases our R^2 value by 0.0001. By removing height, our adjusted R^2 increases from 0.7386 to 0.7396. So, the model without height is a better predictor of neck size than the model including height. 

##########################Add comment about the coefficients, p-values, and intercepts. 
```


```{r}
#Plot residuals
par(mfrow=c(2,2))
plot(neck_lm)

#The Residuals vs Fitted model shows that most of the data points fall equally above and below a horizontal line, but there are two possible outliers. This indicates that there is constant variance between our data points.

#The Normal Q-Q plot shows that the majority of our data points fall on a straight line. However, once again there is a possible outlier which is significantly below the straight line. Because the majority of our data points fall aprroximately on a straight line, this indicates that our data is noramlly distributed.

#The Residuals vs Leverage plot tells us there there is one possible outlier since one of the data points is past the designated area of Cook's distance.
```

```{r}

neck_diag <- ls.diag(no_age_lm)

hi_funusual = 8/282
hi_vunusual = 10/282

Neck <- neck_size %>%
mutate(h_i = neck_diag$hat,
       resid = no_age_lm$resid, 
       stnd_res = neck_diag$std.res, 
       stud_res = neck_diag$stud.res, 
       fitted = no_age_lm$fitted,
       cooks = neck_diag$cooks) %>%
  filter(stnd_res > 2|stnd_res < -2| stud_res > 2|stud_res < -2| cooks >= 0.5| h_i >= hi_funusual)

Neck

```

```{r}
plot(neck ~ age, data = neck_size)
plot(neck ~ weight, data = neck_size)
plot(neck ~ wrist, data = neck_size)
plot(neck ~ bicep, data = neck_size)
plot(neck ~ height, data = neck_size)

#If we look at indiviual scatterplots for each of our predictor variables, we see that weight, wrist size, and bicep size all have fairly strong positive linear correlations with neck size. However, both age and height showed almost no correlation with neck size.
```